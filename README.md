# Лабораторная работа №4

В прошлой лабораторной работе у сверточной нейронной сети для классификации изображений пиццы получилась точность классификации = 66.40%.

## Датасет

Ссылка на датасет - https://www.kaggle.com/datasets/carlosrunner/pizza-not-pizza

Датасет состоит из изображений еды и изображений пиццы

Всего 2 класса.

Изображения изначально разных размеров, приведены изображения к одному размеру 100 на 100 пикселей.

4 примера из датасета:

![dataset](https://github.com/vitalyagr/nn_lab4/assets/170801288/40e1bca4-f06c-452d-a180-2e38678d79f9)

## Попробуем увеличить метрики в данной лабораторной работе.

### Аугментация датасета

Проведём следующие аугментации над тренировочной подвыборкой из датасета:

- Flip - Горизонтальное и вертикальное отражение изображения с вероятностью 25%;
- ElasticTransform(alpha=1.15, sigma=15, alpha_affine=10) - Эластичное преобразование;
- GaussNoise - Гауссовский шум с вероятностью 25%;
- A.Blur(blur_limit=1) - Небольшое размытие изображения.

4 примера аугментированных изображений:

![augmented_preview](https://github.com/vitalyagr/nn_lab4/assets/170801288/bc4accb2-0ec2-4a3b-937d-877157fed561)

### CSP block

Добавим CSP блок перед каждым слоем пуллинга.

### Параметры модели

- batch_size = 64;

- Немного уменьшим learning rate со значения 0.001 до 0.0001;

- Увеличим количество эпох обучения с 5 до 10.

## Результаты работы

Классификатор обучился с точностью 70,67%.

**Точность выросла на 4%.**

**Полученные метрики:**

- Accuracy = 0.7067209775967414 
- Precision = 0.706649077392805 
- Recall = 0.7066970954356846

**Матрица ошибок:**

![confusion](https://github.com/vitalyagr/nn_lab4/assets/170801288/7203e2d4-7057-40d5-9490-0b6d1de8ae25)
